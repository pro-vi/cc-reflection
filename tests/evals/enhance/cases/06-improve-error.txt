improve error handling in the hooks
